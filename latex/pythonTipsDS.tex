%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,12pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
\edef\sphinxdqmaybe{\ifdefined\DeclareUnicodeCharacterAsOptional\string"\fi}
  \DeclareUnicodeCharacter{\sphinxdqmaybe00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\makeatletter
\def\fnum@figure{\figurename\thefigure{}}
\makeatother
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\makeatletter
\def\fnum@table{\tablename\thetable{}}
\makeatother
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}
\addto\captionsenglish{\renewcommand{\sphinxnonalphabeticalgroupname}{Non-alphabetical}}
\addto\captionsenglish{\renewcommand{\sphinxsymbolsname}{Symbols}}
\addto\captionsenglish{\renewcommand{\sphinxnumbersname}{Numbers}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{2}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{dsfont}
\def\Z{\mathbb{Z}}
\def\R{\mathbb{R}}
\def\bX{\mathbf{X}}
\def\X{\mathbf{X}}
\def\By{\mathbf{y}}
\def\Bbeta{\boldsymbol{\beta}}
\def\bU{\mathbf{U}}
\def\bV{\mathbf{V}}
\def\V1{\mathds{1}}
\def\hU{\mathbf{\hat{U}}}
\def\hS{\mathbf{\hat{\Sigma}}}
\def\hV{\mathbf{\hat{V}}}
\def\E{\mathbf{E}}
\def\F{\mathbf{F}}
\def\x{\mathbf{x}}
\def\h{\mathbf{h}}
\def\v{\mathbf{v}}
\def\nv{\mathbf{v^{{f -}}}}
\def\nh{\mathbf{h^{{f -}}}}
\def\s{\mathbf{s}}
\def\b{\mathbf{b}}
\def\c{\mathbf{c}}
\def\W{\mathbf{W}}
\def\C{\mathbf{C}}
\def\P{\mathbf{P}}
\def\T{{\bf \mathcal T}}
\def\B{{\bf \mathcal B}}
\def\euler{\ e^{i\pi} + 1 = 0}


\title{Python Tips for Data Scientist}
\date{February 28, 2019}
\release{1.00}
\author{Wenqiang Feng}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{logo.png}\par}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}\begin{quote}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{logo}.png}
\end{figure}
\end{quote}

Welcome to my \sphinxstylestrong{Python Tips for Data Scientist} notes! In those notes, you will learn some useful tips for Data Scientist daily work. The PDF version can be downloaded from \sphinxhref{pythonTipsDS.pdf}{HERE}.




\chapter{Preface}
\label{\detokenize{preface:preface}}\label{\detokenize{preface:id1}}\label{\detokenize{preface::doc}}
\begin{sphinxadmonition}{note}{Chinese proverb}

The palest ink is better than the best memory. \textendash{} old Chinese proverb
\end{sphinxadmonition}


\section{About}
\label{\detokenize{preface:about}}

\subsection{About this tutorial}
\label{\detokenize{preface:about-this-tutorial}}
This document is a summary of my valueable experiences in using \sphinxcode{\sphinxupquote{Python}} for \sphinxcode{\sphinxupquote{Data Scientist}} daily work. The PDF version can be downloaded from \sphinxhref{sphinxgithub.pdf}{HERE}. \sphinxstylestrong{You may download and distribute it. Please be aware, however, that the note contains typos as well as inaccurate or incorrect description.}

In this repository, I try to use the detailed \sphinxcode{\sphinxupquote{Data Scientist}} related demo code and
examples to share some useful python tips for Data Scientist work. If you find your work wasn’t cited in this note, please feel free to let me know.

Although I am by no means a python programming and Data Scientist expert,
I decided that it would be useful for me to share what I learned
about Python in the form of easy tutorials with detailed example.
I hope those tutorials will be a valuable tool for your studies.

The tutorials assume that the reader has a preliminary knowledge of \sphinxcode{\sphinxupquote{python}} programing, \sphinxcode{\sphinxupquote{LaTex}} and \sphinxcode{\sphinxupquote{Linux}}. And this document is generated automatically by using \sphinxhref{http://sphinx.pocoo.org}{sphinx}.


\subsection{About the authors}
\label{\detokenize{preface:about-the-authors}}\begin{itemize}
\item {} 
\sphinxstylestrong{Wenqiang Feng}
\begin{itemize}
\item {} 
Data Scientist and PhD in Mathematics

\item {} 
University of Tennessee at Knoxville

\item {} 
Email: \sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{itemize}

\item {} 
\sphinxstylestrong{Biography}

Wenqiang Feng is Data Scientist within DST’s Applied Analytics Group. Dr. Feng’s responsibilities include providing DST clients with access to cutting-edge skills and technologies, including Big Data analytic solutions, advanced analytic and data enhancement techniques and modeling.

Dr. Feng has deep analytic expertise in data mining, analytic systems, machine learning algorithms, business intelligence, and applying Big Data tools to strategically solve industry problems in a cross-functional business. Before joining DST, Dr. Feng was an IMA Data Science Fellow at The Institute for Mathematics and its Applications (IMA) at the University of Minnesota. While there, he helped startup companies make marketing decisions based on deep predictive analytics.

Dr. Feng graduated from University of Tennessee, Knoxville, with Ph.D. in Computational Mathematics and Master’s degree in Statistics. He also holds Master’s degree in Computational Mathematics from Missouri University of Science and Technology (MST) and Master’s degree in Applied Mathematics from the University of Science and Technology of China (USTC).

\item {} 
\sphinxstylestrong{Declaration}

The work of Wenqiang Feng was supported by the IMA, while working at IMA. However, any opinion, finding, and conclusions or recommendations expressed in this material are those of the author and do not necessarily reflect the views of the IMA, UTK and DST.

\end{itemize}


\section{Motivation for this tutorial}
\label{\detokenize{preface:motivation-for-this-tutorial}}
No matter you like it or not, Python has been one of the most popular programming languages.
I have been using \sphinxcode{\sphinxupquote{Python}} for almost 4 years. Frankly speaking, I wasn’t impressed and attracted
by \sphinxcode{\sphinxupquote{Python}} at the first using. After starting working in industry, I have to use \sphinxcode{\sphinxupquote{Python}}. Graduately
I recognize the elegance of Python and use it as one of my main programming language. But I foud that:
\begin{itemize}
\item {} 
Most of the \sphinxcode{\sphinxupquote{Python}} books or tutorials which emphasize on programming will overwhelme the green hand.

\item {} 
While most of the \sphinxcode{\sphinxupquote{Python}} books or tutorials \sphinxcode{\sphinxupquote{Data Scientist}} or \sphinxcode{\sphinxupquote{Data Analysis}} didn’t cover some essential skills from the engineer side.

\end{itemize}

So I want to keep some of my valuable tips which are heavily applied in my daily work.


\section{Feedback and suggestions}
\label{\detokenize{preface:feedback-and-suggestions}}
Your comments and suggestions are highly appreciated. I am more than happy to receive
corrections, suggestions or feedbacks through email (Wenqiang Feng: \sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}) for improvements.


\chapter{Python Installation}
\label{\detokenize{install:python-installation}}\label{\detokenize{install:install}}\label{\detokenize{install::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{install:install}]{\sphinxcrossref{\DUrole{std,std-ref}{Python Installation}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}

No matter what operator system is, I will strongly recommend you to install \sphinxcode{\sphinxupquote{Anaconda}} which contains \sphinxcode{\sphinxupquote{Python}}, \sphinxcode{\sphinxupquote{Jupyter}}, \sphinxcode{\sphinxupquote{spyder}}, \sphinxcode{\sphinxupquote{Numpy}}, \sphinxcode{\sphinxupquote{Scipy}}, \sphinxcode{\sphinxupquote{Numba}}, \sphinxcode{\sphinxupquote{pandas}}, \sphinxcode{\sphinxupquote{DASK}},
\sphinxcode{\sphinxupquote{Bokeh}}, \sphinxcode{\sphinxupquote{HoloViews}}, \sphinxcode{\sphinxupquote{Datashader}}, \sphinxcode{\sphinxupquote{matplotlib}}, \sphinxcode{\sphinxupquote{scikit-learn}}, \sphinxcode{\sphinxupquote{H2O.ai}}, \sphinxcode{\sphinxupquote{TensorFlow}}, \sphinxcode{\sphinxupquote{CONDA}} and more.

Download link: \sphinxurl{https://www.anaconda.com/distribution/}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{anaconda}.png}
\end{figure}


\chapter{Notebooks}
\label{\detokenize{nb:notebooks}}\label{\detokenize{nb:nb}}\label{\detokenize{nb::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}


\section{Apache Zeppelin}
\label{\detokenize{nb:apache-zeppelin}}
The \sphinxcode{\sphinxupquote{Zeppelin}} (Apache Zeppelin) is an open-source Web-based notebook that enables data-driven,
interactive data analytics and collaborative documents with \sphinxcode{\sphinxupquote{Python}}, \sphinxcode{\sphinxupquote{PySpark}}, \sphinxcode{\sphinxupquote{SQL}}, \sphinxcode{\sphinxupquote{Scala}} and more.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{zep}.png}
\end{figure}


\section{Jupyter Notebook}
\label{\detokenize{nb:jupyter-notebook}}
The \sphinxcode{\sphinxupquote{Jupyter Notebook}} (Ipython Notebook) is an open-source web application that allows you to create and share documents that contain \sphinxcode{\sphinxupquote{live code}}, \sphinxcode{\sphinxupquote{equations}}, \sphinxcode{\sphinxupquote{visualizations}} and \sphinxcode{\sphinxupquote{narrative text}}. Uses include: data cleaning and transformation, numerical simulation, statistical modeling, data visualization, machine learning, and much more.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{ipynb}.png}
\end{figure}


\chapter{Primer Functions}
\label{\detokenize{primer:primer-functions}}\label{\detokenize{primer:primer}}\label{\detokenize{primer::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{primer:primer}]{\sphinxcrossref{\DUrole{std,std-ref}{Primer Functions}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}

The following \sphinxcode{\sphinxupquote{functions}} have been heavily used in my daily Data Scientist work.


\section{\sphinxstyleliteralintitle{\sphinxupquote{*}}}
\label{\detokenize{primer:id1}}
Single asterisk as used in function declaration allows variable number of arguments passed from calling environment. Inside the function it behaves as a tuple.

\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{k}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\PYG{k}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{l+m+mi}{1} \PYG{l+m+mi}{2} \PYG{l+m+mi}{3}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{range}}}
\label{\detokenize{primer:range}}
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{print}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{l+m+mi}{0} \PYG{l+m+mi}{1} \PYG{l+m+mi}{2} \PYG{l+m+mi}{3} \PYG{l+m+mi}{4}
\PYG{l+m+mi}{3} \PYG{l+m+mi}{4} \PYG{l+m+mi}{5} \PYG{l+m+mi}{6} \PYG{l+m+mi}{7}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{random}}}
\label{\detokenize{primer:random}}
More details can be found at:
\begin{enumerate}
\def\theenumi{\alph{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
\sphinxcode{\sphinxupquote{random}}: \sphinxurl{https://docs.python.org/3/library/random.html\#random.randint}

\item {} 
\sphinxcode{\sphinxupquote{np.random}}: \sphinxurl{https://docs.scipy.org/doc/numpy/reference/routines.random.html}

\end{enumerate}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{random.random}}}
\label{\detokenize{primer:random-random}}
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{random}
\PYG{n}{random}\PYG{o}{.}\PYG{n}{random}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} (b \PYGZhy{} a) * random() + a}
\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{0.33844051243073625}
\PYG{l+m+mf}{7.772024014335885}
\end{sphinxVerbatim}
\end{quote}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{np.random}}}
\label{\detokenize{primer:np-random}}
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} (b \PYGZhy{} a) * random\PYGZus{}sample() + a}
\PYG{n}{a} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{;} \PYG{n}{b} \PYG{o}{=} \PYG{l+m+mi}{8}
\PYG{p}{(}\PYG{n}{b}\PYG{o}{\PYGZhy{}}\PYG{n}{a}\PYG{p}{)}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{n}{a}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{0.11919402208670005}
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.07384755}\PYG{p}{,} \PYG{l+m+mf}{0.9005251} \PYG{p}{,} \PYG{l+m+mf}{0.30030561}\PYG{p}{,} \PYG{l+m+mf}{0.38221819}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{0.76851156}\PYG{p}{,} \PYG{l+m+mf}{0.56973309}\PYG{p}{,} \PYG{l+m+mf}{0.47074505}\PYG{p}{,} \PYG{l+m+mf}{0.7814957} \PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{0.5778028} \PYG{p}{,} \PYG{l+m+mf}{0.94653057}\PYG{p}{,} \PYG{l+m+mf}{0.51193493}\PYG{p}{,} \PYG{l+m+mf}{0.48693931}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{4.65799262}\PYG{p}{,} \PYG{l+m+mf}{6.32702018}\PYG{p}{,} \PYG{l+m+mf}{6.55545234}\PYG{p}{,} \PYG{l+m+mf}{5.45877784}\PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{7.69941994}\PYG{p}{,} \PYG{l+m+mf}{4.68709357}\PYG{p}{,} \PYG{l+m+mf}{5.49790728}\PYG{p}{,} \PYG{l+m+mf}{4.60913966}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{round}}}
\label{\detokenize{primer:round}}
Sometimes, we really do not need the scientific decimals for \sphinxcode{\sphinxupquote{output}} results. So you can use this function to round an array to the given number of decimals.

\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{0.76}\PYG{p}{,} \PYG{l+m+mf}{0.06}\PYG{p}{,} \PYG{l+m+mf}{0.41}\PYG{p}{,} \PYG{l+m+mf}{0.4} \PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{0.07}\PYG{p}{,} \PYG{l+m+mf}{0.51}\PYG{p}{,} \PYG{l+m+mf}{0.84}\PYG{p}{,} \PYG{l+m+mf}{0.76}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{TODO..}
\label{\detokenize{primer:todo}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}


\chapter{Data Structures}
\label{\detokenize{struct:data-structures}}\label{\detokenize{struct:struct}}\label{\detokenize{struct::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{struct:struct}]{\sphinxcrossref{\DUrole{std,std-ref}{Data Structures}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}


\section{List}
\label{\detokenize{struct:list}}
\sphinxcode{\sphinxupquote{List}} is one of data sctructures which is heavily using in my daily work.


\subsection{Create list}
\label{\detokenize{struct:create-list}}\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Create empty list

\end{enumerate}

The empty list is used to initialize a list.

\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
\PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{list}
\end{sphinxVerbatim}
\end{quote}

I applied the empty list to initialize my \sphinxcode{\sphinxupquote{silhouette score}} list when I try to find the
optimal number of the clusters.

\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{min\PYGZus{}cluster} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{n}{max\PYGZus{}cluster} \PYG{o}{=}\PYG{l+m+mi}{8}

\PYG{c+c1}{\PYGZsh{} silhouette\PYGZus{}score}
\PYG{n}{scores} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{min\PYGZus{}cluster}\PYG{p}{,} \PYG{n}{max\PYGZus{}cluster}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{score} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{scores}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{score}\PYG{p}{)}

\PYG{k}{print}\PYG{p}{(}\PYG{n}{scores}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+m+mf}{0.16}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.3}\PYG{p}{,} \PYG{l+m+mf}{0.87}\PYG{p}{,} \PYG{l+m+mf}{0.59}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}


\subsection{Unpack list}
\label{\detokenize{struct:unpack-list}}

\section{Tuple}
\label{\detokenize{struct:tuple}}
A tuple is an assortment of data, separated by commas, which makes it similar to the Python list, but a tuple is fundamentally different in that a tuple is “immutable.” This means that it cannot be changed, modified, or manipulated.

\sphinxcite{reference:vanderplas2016} \sphinxcite{reference:mckinney2013} \sphinxcite{reference:georg2018}


\chapter{\sphinxstyleliteralintitle{\sphinxupquote{pd.DataFrame}} manipulation}
\label{\detokenize{pd:pd-dataframe-manipulation}}\label{\detokenize{pd:pd}}\label{\detokenize{pd::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}


\section{TODO..}
\label{\detokenize{pd:todo}}

\chapter{\sphinxstyleliteralintitle{\sphinxupquote{rdd.DataFrame}} manipulation}
\label{\detokenize{rdd:rdd-dataframe-manipulation}}\label{\detokenize{rdd:rdd}}\label{\detokenize{rdd::doc}}
\begin{sphinxadmonition}{note}{Note:}
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}


\section{TODO..}
\label{\detokenize{rdd:todo}}

\chapter{\sphinxstyleliteralintitle{\sphinxupquote{pd.DataFrame}} vs \sphinxstyleliteralintitle{\sphinxupquote{pd.DataFrame}}}
\label{\detokenize{pdrdd:pd-dataframe-vs-pd-dataframe}}\label{\detokenize{pdrdd:pdrdd}}\label{\detokenize{pdrdd::doc}}

\section{Create DataFrame}
\label{\detokenize{pdrdd:create-dataframe}}

\subsection{From DataBase}
\label{\detokenize{pdrdd:from-database}}
login.txt:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
runawayhorse001
PythonTips
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}User Information}
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{login} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{login.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{n+nb+bp}{None}\PYG{p}{)}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{pw} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{User information is ready!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Login information is not avaliable!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Database information}
\PYG{n}{host} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{db\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{db\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{table\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{table\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{conn} \PYG{o}{=} \PYG{n}{psycopg2}\PYG{o}{.}\PYG{n}{connect}\PYG{p}{(}\PYG{n}{host}\PYG{o}{=}\PYG{n}{host}\PYG{p}{,} \PYG{n}{database}\PYG{o}{=}\PYG{n}{db\PYGZus{}name}\PYG{p}{,} \PYG{n}{user}\PYG{o}{=}\PYG{n}{user}\PYG{p}{,} \PYG{n}{password}\PYG{o}{=}\PYG{n}{pw}\PYG{p}{)}
\PYG{n}{cur} \PYG{o}{=} \PYG{n}{conn}\PYG{o}{.}\PYG{n}{cursor}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{sql} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{      select *}
\PYG{l+s+s2}{      from \PYGZob{}table\PYGZus{}name\PYGZcb{}}
\PYG{l+s+s2}{      }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{table\PYGZus{}name}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}sql}\PYG{p}{(}\PYG{n}{sql}\PYG{p}{,} \PYG{n}{conn}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} connect to database}
\PYG{n}{url} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jdbc:postgresql://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{host}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:5432/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{db\PYGZus{}name}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{?user=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{user}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZam{}password=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{pw}
\PYG{n}{properties} \PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{driver}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{org.postgresql.Driver}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{password}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{pw}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{user}\PYG{p}{\PYGZcb{}}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{jdbc}\PYG{p}{(}\PYG{n}{url}\PYG{o}{=}\PYG{n}{url}\PYG{p}{,} \PYG{n}{table}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{,} \PYG{n}{properties}\PYG{o}{=}\PYG{n}{properties}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{From List}
\label{\detokenize{pdrdd:from-list}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution for the columns=}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                  \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                  \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}  \PYG{n}{C}\PYG{o}{\textbar{}}
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}        \PYG{o}{\textbar{}}  \PYG{n}{a}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}        \PYG{o}{\textbar{}}  \PYG{n}{b}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}        \PYG{o}{\textbar{}}  \PYG{n}{c}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{4}\PYG{o}{\textbar{}}
                  \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{attention}{Attention:}
Pay attentation to the parameter \sphinxcode{\sphinxupquote{columns=}} in \sphinxcode{\sphinxupquote{pd.DataFrame}}. Since the default value will make the list as rows.
\begin{quote}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution for the columns=}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}             \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}
\PYG{l+m+mi}{0}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}          \PYG{n}{A}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}
\PYG{l+m+mi}{1}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}          \PYG{n}{B}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}
\PYG{l+m+mi}{2}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}          \PYG{n}{C}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}
\end{sphinxVerbatim}
\end{quote}
\end{sphinxadmonition}


\subsection{From Dict}
\label{\detokenize{pdrdd:from-dict}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{d} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
     \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
     \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}\PYG{k}{for}
\PYG{c+c1}{\PYGZsh{} Tedious for PySpark}
\PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{d}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{d}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                   \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}  \PYG{n}{C}\PYG{o}{\textbar{}}
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}         \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}         \PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{0}         \PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}         \PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}
                   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Load DataFrame}
\label{\detokenize{pdrdd:load-dataframe}}

\subsection{From \sphinxstyleliteralintitle{\sphinxupquote{.csv}}}
\label{\detokenize{pdrdd:from-csv}}

\subsection{From \sphinxstyleliteralintitle{\sphinxupquote{.json}}}
\label{\detokenize{pdrdd:from-json}}
Data from: \sphinxurl{http://api.luftdaten.info/static/v1/data.json}


\subsection{From DataBase}
\label{\detokenize{pdrdd:id1}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}json}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{data/data.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{json}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data/data.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}        \PYG{n+nb}{id}\PYG{o}{\textbar{}}          \PYG{n}{timestamp}\PYG{o}{\textbar{}}
            \PYG{n+nb}{id}  \PYG{n}{timestamp}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}   \PYG{l+m+mi}{2994551481}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{\textbar{}}\PYG{l+m+mi}{2994551481}\PYG{o}{\textbar{}}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mi}{2994551482}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{\textbar{}}\PYG{l+m+mi}{2994551482}\PYG{o}{\textbar{}}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mi}{2994551483}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{\textbar{}}\PYG{l+m+mi}{2994551483}\PYG{o}{\textbar{}}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}   \PYG{l+m+mi}{2994551484}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{\textbar{}}\PYG{l+m+mi}{2994551484}\PYG{o}{\textbar{}}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mo}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{First \sphinxstyleliteralintitle{\sphinxupquote{n}} Rows}
\label{\detokenize{pdrdd:first-n-rows}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}       \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}       \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}       \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}       \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Column Names}
\label{\detokenize{pdrdd:column-names}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{columns}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{columns}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Index}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{dtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{object}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}


\section{Data types}
\label{\detokenize{pdrdd:data-types}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{dtypes}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{dtypes}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{TV}           \PYG{n}{float64}                    \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Radio}        \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Newspaper}    \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Sales}        \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{dtype}\PYG{p}{:} \PYG{n+nb}{object}
\end{sphinxVerbatim}


\section{Fill Null}
\label{\detokenize{pdrdd:fill-null}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n+nb+bp}{None}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}     \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}
        \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{male}  \PYG{l+m+mi}{1}  \PYG{n}{NaN}                       \PYG{o}{\textbar{}}  \PYG{n}{male}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{female}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                       \PYG{o}{\textbar{}}\PYG{n}{female}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}    \PYG{n}{male}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                       \PYG{o}{\textbar{}}  \PYG{n}{male}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{4}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{fillna}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{fillna}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}     \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}
        \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{male}  \PYG{l+m+mi}{1}  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}                       \PYG{o}{\textbar{}}  \PYG{n}{male}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{female}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                       \PYG{o}{\textbar{}}\PYG{n}{female}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}    \PYG{n}{male}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                       \PYG{o}{\textbar{}}  \PYG{n}{male}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{4}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Replace Values}
\label{\detokenize{pdrdd:replace-values}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution: you need to chose specific col}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{A}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{female}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}
\PYG{n}{dp}
\PYG{c+c1}{\PYGZsh{}caution: Mixed type replacements are not supported}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{na}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{female}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}
   \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                    \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}  \PYG{n}{NaN}                    \PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                    \PYG{o}{\textbar{}}  \PYG{l+m+mi}{0}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                    \PYG{o}{\textbar{}}  \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{4}\PYG{o}{\textbar{}}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Rename Columns}
\label{\detokenize{pdrdd:rename-columns}}

\subsection{Rename all columns}
\label{\detokenize{pdrdd:rename-all-columns}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{columns} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{toDF}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}    \PYG{n}{a}\PYG{o}{\textbar{}}   \PYG{n}{b}\PYG{o}{\textbar{}}   \PYG{n}{c}\PYG{o}{\textbar{}}   \PYG{n}{d}\PYG{o}{\textbar{}}
       \PYG{n}{a}     \PYG{n}{b}     \PYG{n}{c}     \PYG{n}{d}                      \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}  \PYG{l+m+mf}{37.8}  \PYG{l+m+mf}{69.2}  \PYG{l+m+mf}{22.1}                      \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}}\PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}\PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}}\PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}  \PYG{l+m+mf}{39.3}  \PYG{l+m+mf}{45.1}  \PYG{l+m+mf}{10.4}                      \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}}\PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}  \PYG{l+m+mf}{45.9}  \PYG{l+m+mf}{69.3}   \PYG{l+m+mf}{9.3}                      \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}}\PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}\PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}  \PYG{l+m+mf}{41.3}  \PYG{l+m+mf}{58.5}  \PYG{l+m+mf}{18.5}                      \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\subsection{Rename one or more columns}
\label{\detokenize{pdrdd:rename-one-or-more-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mapping} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{mapping}\PYG{p}{)}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{new\PYGZus{}names} \PYG{o}{=} \PYG{p}{[}\PYG{n}{mapping}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{n}{col}\PYG{p}{,}\PYG{n}{col}\PYG{p}{)} \PYG{k}{for} \PYG{n}{col} \PYG{o+ow}{in} \PYG{n}{ds}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{]}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{toDF}\PYG{p}{(}\PYG{o}{*}\PYG{n}{new\PYGZus{}names}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}   \PYG{n}{D}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}     \PYG{n}{C}     \PYG{n}{D}             \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}  \PYG{l+m+mf}{69.2}  \PYG{l+m+mf}{22.1}             \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}\PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}}\PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}  \PYG{l+m+mf}{45.1}  \PYG{l+m+mf}{10.4}             \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}}\PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}  \PYG{l+m+mf}{69.3}   \PYG{l+m+mf}{9.3}             \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}\PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}  \PYG{l+m+mf}{58.5}  \PYG{l+m+mf}{18.5}             \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
You can also use \sphinxcode{\sphinxupquote{withColumnRenamed}} to rename one column in PySpark.

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumnRenamed}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Paper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Paper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}} \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}
\PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}
\PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}} \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}
\PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}
\end{sphinxadmonition}


\section{Drop Columns}
\label{\detokenize{pdrdd:drop-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{drop\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{n}{drop\PYGZus{}name}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{o}{*}\PYG{n}{drop\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}                 \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}                 \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}                 \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}                 \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}                 \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Filter}
\label{\detokenize{pdrdd:filter}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{csv}\PYG{p}{(}\PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{header}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{,}
                    \PYG{n}{inferSchema}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{n}{dp}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{p}{[}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}
       \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}              \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{7}   \PYG{l+m+mf}{120.2}   \PYG{l+m+mf}{19.6}       \PYG{l+m+mf}{11.6}   \PYG{l+m+mf}{13.2}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{120.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{19.6}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{11.6}\PYG{o}{\textbar{}} \PYG{l+m+mf}{13.2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{8}     \PYG{l+m+mf}{8.6}    \PYG{l+m+mf}{2.1}        \PYG{l+m+mf}{1.0}    \PYG{l+m+mf}{4.8}              \PYG{o}{\textbar{}}  \PYG{l+m+mf}{8.6}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{2.1}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{1.0}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{4.8}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{11}  \PYG{l+m+mf}{214.7}   \PYG{l+m+mf}{24.0}        \PYG{l+m+mf}{4.0}   \PYG{l+m+mf}{17.4}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{214.7}\PYG{o}{\textbar{}} \PYG{l+m+mf}{24.0}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{4.0}\PYG{o}{\textbar{}} \PYG{l+m+mf}{17.4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{13}   \PYG{l+m+mf}{97.5}    \PYG{l+m+mf}{7.6}        \PYG{l+m+mf}{7.2}    \PYG{l+m+mf}{9.7}              \PYG{o}{\textbar{}} \PYG{l+m+mf}{97.5}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{7.6}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{7.2}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.7}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dp}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{dp}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{p}{[}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}
       \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}              \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{7}   \PYG{l+m+mf}{120.2}   \PYG{l+m+mf}{19.6}       \PYG{l+m+mf}{11.6}   \PYG{l+m+mf}{13.2}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{120.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{19.6}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{11.6}\PYG{o}{\textbar{}} \PYG{l+m+mf}{13.2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{11}  \PYG{l+m+mf}{214.7}   \PYG{l+m+mf}{24.0}        \PYG{l+m+mf}{4.0}   \PYG{l+m+mf}{17.4}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{214.7}\PYG{o}{\textbar{}} \PYG{l+m+mf}{24.0}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{4.0}\PYG{o}{\textbar{}} \PYG{l+m+mf}{17.4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{19}  \PYG{l+m+mf}{147.3}   \PYG{l+m+mf}{23.9}       \PYG{l+m+mf}{19.1}   \PYG{l+m+mf}{14.6}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{147.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{23.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{19.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{14.6}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{25}  \PYG{l+m+mf}{262.9}    \PYG{l+m+mf}{3.5}       \PYG{l+m+mf}{19.5}   \PYG{l+m+mf}{12.0}              \PYG{o}{\textbar{}}\PYG{l+m+mf}{262.9}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{3.5}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{19.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{12.0}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{With New Column}
\label{\detokenize{pdrdd:with-new-column}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv\PYGZus{}norm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{dp}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{/}\PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{dp}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv\PYGZus{}norm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ds}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{/}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{n}{F}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{TV}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{collect}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}             \PYG{n}{tv\PYGZus{}norm}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}   \PYG{n}{tv\PYGZus{}norm}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{0.007824}     \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}\PYG{l+m+mf}{0.007824268493802813}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}  \PYG{l+m+mf}{0.001513}     \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}\PYG{l+m+mf}{0.001513167961643}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}  \PYG{l+m+mf}{0.000585}     \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{5.848649200061207E\PYGZhy{}4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{0.005152}     \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{0.005151571824472517}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cond}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{dp}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{c}\PYG{p}{:} \PYG{l+m+mi}{1} \PYG{k}{if} \PYG{p}{(}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{Radio}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)} \PYG{k}{else} \PYG{l+m+mi}{2} \PYG{k}{if} \PYG{n}{c}\PYG{o}{.}\PYG{n}{Sales}\PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{10} \PYG{k}{else} \PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cond}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{when}\PYG{p}{(}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{Radio}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYGZbs{}
                      \PYG{o}{.}\PYG{n}{when}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{Sales}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYGZbs{}
                      \PYG{o}{.}\PYG{n}{otherwise}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}\PYG{n}{cond}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}  \PYG{n}{cond}         \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}     \PYG{l+m+mi}{1}         \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}     \PYG{l+m+mi}{2}         \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}     \PYG{l+m+mi}{3}         \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}     \PYG{l+m+mi}{2}         \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log\PYGZus{}tv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{dp}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log\PYGZus{}tv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}            \PYG{n}{log\PYGZus{}tv}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}    \PYG{n}{log\PYGZus{}tv}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{5.438514}     \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{5.43851399704132}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}  \PYG{l+m+mf}{3.795489}     \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}}\PYG{l+m+mf}{3.7954891891721947}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}  \PYG{l+m+mf}{2.844909}     \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}}\PYG{l+m+mf}{2.8449093838194073}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{5.020586}     \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{5.020585624949423}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv+10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{dp}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv+10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ds}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{\textbar{}}   \PYG{n}{TV}\PYG{o}{\textbar{}}\PYG{n}{Radio}\PYG{o}{\textbar{}}\PYG{n}{Newspaper}\PYG{o}{\textbar{}}\PYG{n}{Sales}\PYG{o}{\textbar{}}\PYG{n}{tv}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{\textbar{}}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}  \PYG{n}{tv}\PYG{o}{+}\PYG{l+m+mi}{10}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{240.1}        \PYG{o}{\textbar{}}\PYG{l+m+mf}{230.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{37.8}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{22.1}\PYG{o}{\textbar{}}\PYG{l+m+mf}{240.1}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}   \PYG{l+m+mf}{54.5}        \PYG{o}{\textbar{}} \PYG{l+m+mf}{44.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{39.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{45.1}\PYG{o}{\textbar{}} \PYG{l+m+mf}{10.4}\PYG{o}{\textbar{}} \PYG{l+m+mf}{54.5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}   \PYG{l+m+mf}{27.2}        \PYG{o}{\textbar{}} \PYG{l+m+mf}{17.2}\PYG{o}{\textbar{}} \PYG{l+m+mf}{45.9}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{69.3}\PYG{o}{\textbar{}}  \PYG{l+m+mf}{9.3}\PYG{o}{\textbar{}} \PYG{l+m+mf}{27.2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{161.5}        \PYG{o}{\textbar{}}\PYG{l+m+mf}{151.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{41.3}\PYG{o}{\textbar{}}     \PYG{l+m+mf}{58.5}\PYG{o}{\textbar{}} \PYG{l+m+mf}{18.5}\PYG{o}{\textbar{}}\PYG{l+m+mf}{161.5}\PYG{o}{\textbar{}}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Join}
\label{\detokenize{pdrdd:join}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                    \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{rightp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{G}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                       \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{lefts} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{leftp}\PYG{p}{)}
\PYG{n}{rights} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}                   \PYG{n}{A}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}               \PYG{l+m+mi}{4}  \PYG{n}{A0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}               \PYG{l+m+mi}{5}  \PYG{n}{A1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}
\PYG{l+m+mi}{2}  \PYG{n}{A2}  \PYG{n}{B2}  \PYG{n}{C2}  \PYG{n}{D2}               \PYG{l+m+mi}{6}  \PYG{n}{A6}  \PYG{n}{B6}  \PYG{n}{C6}  \PYG{n}{D6}
\PYG{l+m+mi}{3}  \PYG{n}{A3}  \PYG{n}{B3}  \PYG{n}{C3}  \PYG{n}{D3}               \PYG{l+m+mi}{7}  \PYG{n}{A7}  \PYG{n}{B7}  \PYG{n}{C7}  \PYG{n}{D7}
\end{sphinxVerbatim}


\subsection{Left Join}
\label{\detokenize{pdrdd:left-join}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}  \PYG{n}{C}\PYG{o}{\textbar{}}  \PYG{n}{D}\PYG{o}{\textbar{}}   \PYG{n}{F}\PYG{o}{\textbar{}}   \PYG{n}{G}\PYG{o}{\textbar{}}   \PYG{n}{H}\PYG{o}{\textbar{}}
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}    \PYG{n}{F}    \PYG{n}{G}    \PYG{n}{H}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}   \PYG{n}{B4}   \PYG{n}{C4}   \PYG{n}{D4}        \PYG{o}{\textbar{}} \PYG{n}{A0}\PYG{o}{\textbar{}} \PYG{n}{B0}\PYG{o}{\textbar{}} \PYG{n}{C0}\PYG{o}{\textbar{}} \PYG{n}{D0}\PYG{o}{\textbar{}}  \PYG{n}{B4}\PYG{o}{\textbar{}}  \PYG{n}{C4}\PYG{o}{\textbar{}}  \PYG{n}{D4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}   \PYG{n}{B5}   \PYG{n}{C5}   \PYG{n}{D5}        \PYG{o}{\textbar{}} \PYG{n}{A1}\PYG{o}{\textbar{}} \PYG{n}{B1}\PYG{o}{\textbar{}} \PYG{n}{C1}\PYG{o}{\textbar{}} \PYG{n}{D1}\PYG{o}{\textbar{}}  \PYG{n}{B5}\PYG{o}{\textbar{}}  \PYG{n}{C5}\PYG{o}{\textbar{}}  \PYG{n}{D5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{n}{A2}  \PYG{n}{B2}  \PYG{n}{C2}  \PYG{n}{D2}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}        \PYG{o}{\textbar{}} \PYG{n}{A2}\PYG{o}{\textbar{}} \PYG{n}{B2}\PYG{o}{\textbar{}} \PYG{n}{C2}\PYG{o}{\textbar{}} \PYG{n}{D2}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{n}{A3}  \PYG{n}{B3}  \PYG{n}{C3}  \PYG{n}{D3}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}        \PYG{o}{\textbar{}} \PYG{n}{A3}\PYG{o}{\textbar{}} \PYG{n}{B3}\PYG{o}{\textbar{}} \PYG{n}{C3}\PYG{o}{\textbar{}} \PYG{n}{D3}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Right Join}
\label{\detokenize{pdrdd:right-join}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}   \PYG{n}{B}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}   \PYG{n}{D}\PYG{o}{\textbar{}}  \PYG{n}{F}\PYG{o}{\textbar{}}  \PYG{n}{G}\PYG{o}{\textbar{}}  \PYG{n}{H}\PYG{o}{\textbar{}}
    \PYG{n}{A}    \PYG{n}{B}    \PYG{n}{C}    \PYG{n}{D}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}   \PYG{n}{B0}   \PYG{n}{C0}   \PYG{n}{D0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}        \PYG{o}{\textbar{}} \PYG{n}{A0}\PYG{o}{\textbar{}}  \PYG{n}{B0}\PYG{o}{\textbar{}}  \PYG{n}{C0}\PYG{o}{\textbar{}}  \PYG{n}{D0}\PYG{o}{\textbar{}} \PYG{n}{B4}\PYG{o}{\textbar{}} \PYG{n}{C4}\PYG{o}{\textbar{}} \PYG{n}{D4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{A1}   \PYG{n}{B1}   \PYG{n}{C1}   \PYG{n}{D1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}        \PYG{o}{\textbar{}} \PYG{n}{A1}\PYG{o}{\textbar{}}  \PYG{n}{B1}\PYG{o}{\textbar{}}  \PYG{n}{C1}\PYG{o}{\textbar{}}  \PYG{n}{D1}\PYG{o}{\textbar{}} \PYG{n}{B5}\PYG{o}{\textbar{}} \PYG{n}{C5}\PYG{o}{\textbar{}} \PYG{n}{D5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{n}{A6}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{B6}  \PYG{n}{C6}  \PYG{n}{D6}        \PYG{o}{\textbar{}} \PYG{n}{A6}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}} \PYG{n}{B6}\PYG{o}{\textbar{}} \PYG{n}{C6}\PYG{o}{\textbar{}} \PYG{n}{D6}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{n}{A7}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{B7}  \PYG{n}{C7}  \PYG{n}{D7}        \PYG{o}{\textbar{}} \PYG{n}{A7}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}} \PYG{n}{B7}\PYG{o}{\textbar{}} \PYG{n}{C7}\PYG{o}{\textbar{}} \PYG{n}{D7}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Inner Join}
\label{\detokenize{pdrdd:inner-join}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}  \PYG{n}{B}\PYG{o}{\textbar{}}  \PYG{n}{C}\PYG{o}{\textbar{}}  \PYG{n}{D}\PYG{o}{\textbar{}}  \PYG{n}{F}\PYG{o}{\textbar{}}  \PYG{n}{G}\PYG{o}{\textbar{}}  \PYG{n}{H}\PYG{o}{\textbar{}}
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}   \PYG{o}{\textbar{}} \PYG{n}{A0}\PYG{o}{\textbar{}} \PYG{n}{B0}\PYG{o}{\textbar{}} \PYG{n}{C0}\PYG{o}{\textbar{}} \PYG{n}{D0}\PYG{o}{\textbar{}} \PYG{n}{B4}\PYG{o}{\textbar{}} \PYG{n}{C4}\PYG{o}{\textbar{}} \PYG{n}{D4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}   \PYG{o}{\textbar{}} \PYG{n}{A1}\PYG{o}{\textbar{}} \PYG{n}{B1}\PYG{o}{\textbar{}} \PYG{n}{C1}\PYG{o}{\textbar{}} \PYG{n}{D1}\PYG{o}{\textbar{}} \PYG{n}{B5}\PYG{o}{\textbar{}} \PYG{n}{C5}\PYG{o}{\textbar{}} \PYG{n}{D5}\PYG{o}{\textbar{}}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Full Join}
\label{\detokenize{pdrdd:full-join}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{full}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{full}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}  \PYG{n}{A}\PYG{o}{\textbar{}}   \PYG{n}{B}\PYG{o}{\textbar{}}   \PYG{n}{C}\PYG{o}{\textbar{}}   \PYG{n}{D}\PYG{o}{\textbar{}}   \PYG{n}{F}\PYG{o}{\textbar{}}   \PYG{n}{G}\PYG{o}{\textbar{}}   \PYG{n}{H}\PYG{o}{\textbar{}}
    \PYG{n}{A}    \PYG{n}{B}    \PYG{n}{C}    \PYG{n}{D}    \PYG{n}{F}    \PYG{n}{G}    \PYG{n}{H}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}   \PYG{n}{B0}   \PYG{n}{C0}   \PYG{n}{D0}   \PYG{n}{B4}   \PYG{n}{C4}   \PYG{n}{D4}     \PYG{o}{\textbar{}} \PYG{n}{A0}\PYG{o}{\textbar{}}  \PYG{n}{B0}\PYG{o}{\textbar{}}  \PYG{n}{C0}\PYG{o}{\textbar{}}  \PYG{n}{D0}\PYG{o}{\textbar{}}  \PYG{n}{B4}\PYG{o}{\textbar{}}  \PYG{n}{C4}\PYG{o}{\textbar{}}  \PYG{n}{D4}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}  \PYG{n}{A1}   \PYG{n}{B1}   \PYG{n}{C1}   \PYG{n}{D1}   \PYG{n}{B5}   \PYG{n}{C5}   \PYG{n}{D5}     \PYG{o}{\textbar{}} \PYG{n}{A1}\PYG{o}{\textbar{}}  \PYG{n}{B1}\PYG{o}{\textbar{}}  \PYG{n}{C1}\PYG{o}{\textbar{}}  \PYG{n}{D1}\PYG{o}{\textbar{}}  \PYG{n}{B5}\PYG{o}{\textbar{}}  \PYG{n}{C5}\PYG{o}{\textbar{}}  \PYG{n}{D5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}  \PYG{n}{A2}   \PYG{n}{B2}   \PYG{n}{C2}   \PYG{n}{D2}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}     \PYG{o}{\textbar{}} \PYG{n}{A2}\PYG{o}{\textbar{}}  \PYG{n}{B2}\PYG{o}{\textbar{}}  \PYG{n}{C2}\PYG{o}{\textbar{}}  \PYG{n}{D2}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}  \PYG{n}{A3}   \PYG{n}{B3}   \PYG{n}{C3}   \PYG{n}{D3}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}     \PYG{o}{\textbar{}} \PYG{n}{A3}\PYG{o}{\textbar{}}  \PYG{n}{B3}\PYG{o}{\textbar{}}  \PYG{n}{C3}\PYG{o}{\textbar{}}  \PYG{n}{D3}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{4}  \PYG{n}{A6}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}   \PYG{n}{B6}   \PYG{n}{C6}   \PYG{n}{D6}     \PYG{o}{\textbar{}} \PYG{n}{A6}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}  \PYG{n}{B6}\PYG{o}{\textbar{}}  \PYG{n}{C6}\PYG{o}{\textbar{}}  \PYG{n}{D6}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{5}  \PYG{n}{A7}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}   \PYG{n}{B7}   \PYG{n}{C7}   \PYG{n}{D7}     \PYG{o}{\textbar{}} \PYG{n}{A7}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}  \PYG{n}{B7}\PYG{o}{\textbar{}}  \PYG{n}{C7}\PYG{o}{\textbar{}}  \PYG{n}{D7}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Concat Columns}
\label{\detokenize{pdrdd:concat-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{schema}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
  \PYG{n}{col1}  \PYG{n}{col2}  \PYG{n}{col3}
\PYG{l+m+mi}{0}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}
\PYG{l+m+mi}{1}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}
\PYG{l+m+mi}{2}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}
\PYG{l+m+mi}{3}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}
\PYG{l+m+mi}{4}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}
\PYG{l+m+mi}{5}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{concat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{dp}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{\PYGZpc{}}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{dp}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{concat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{\textbar{}}\PYG{n}{col1}\PYG{o}{\textbar{}}\PYG{n}{col2}\PYG{o}{\textbar{}}\PYG{n}{col3}\PYG{o}{\textbar{}}\PYG{n}{concat}\PYG{o}{\textbar{}}
  \PYG{n}{col1}  \PYG{n}{col2}  \PYG{n}{col3} \PYG{n}{concat}               \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}     \PYG{n}{a2}               \PYG{o}{\textbar{}}   \PYG{n}{a}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}    \PYG{n}{a2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{1}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}     \PYG{n}{b5}               \PYG{o}{\textbar{}}   \PYG{n}{b}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{5}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{6}\PYG{o}{\textbar{}}    \PYG{n}{b5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{2}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}     \PYG{n}{c8}               \PYG{o}{\textbar{}}   \PYG{n}{c}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{8}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{9}\PYG{o}{\textbar{}}    \PYG{n}{c8}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{3}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}     \PYG{n}{a2}               \PYG{o}{\textbar{}}   \PYG{n}{a}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{3}\PYG{o}{\textbar{}}    \PYG{n}{a2}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{4}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}     \PYG{n}{b5}               \PYG{o}{\textbar{}}   \PYG{n}{b}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{5}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{6}\PYG{o}{\textbar{}}    \PYG{n}{b5}\PYG{o}{\textbar{}}
\PYG{l+m+mi}{5}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}     \PYG{n}{c8}               \PYG{o}{\textbar{}}   \PYG{n}{c}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{8}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{9}\PYG{o}{\textbar{}}    \PYG{n}{c8}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{GroupBy}
\label{\detokenize{pdrdd:groupby}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dp}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
      \PYG{n}{col2}  \PYG{n}{col3}                        \PYG{o}{\textbar{}}\PYG{n}{col1}\PYG{o}{\textbar{}}\PYG{n+nb}{min}\PYG{p}{(}\PYG{n}{col2}\PYG{p}{)}\PYG{o}{\textbar{}}\PYG{n}{avg}\PYG{p}{(}\PYG{n}{col3}\PYG{p}{)}\PYG{o}{\textbar{}}
\PYG{n}{col1}                                    \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{a}        \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}                        \PYG{o}{\textbar{}}   \PYG{n}{c}\PYG{o}{\textbar{}}        \PYG{l+m+mi}{8}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{9.0}\PYG{o}{\textbar{}}
\PYG{n}{b}        \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}                        \PYG{o}{\textbar{}}   \PYG{n}{b}\PYG{o}{\textbar{}}        \PYG{l+m+mi}{5}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{6.0}\PYG{o}{\textbar{}}
\PYG{n}{c}        \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}                        \PYG{o}{\textbar{}}   \PYG{n}{a}\PYG{o}{\textbar{}}        \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}      \PYG{l+m+mf}{3.0}\PYG{o}{\textbar{}}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Pivot}
\label{\detokenize{pdrdd:pivot}}
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{pivot\PYGZus{}table}\PYG{p}{(}\PYG{n}{dp}\PYG{p}{,} \PYG{n}{values}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{aggfunc}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{ds}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{pivot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{col2}    \PYG{l+m+mi}{2}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{8}           \PYG{o}{\textbar{}}\PYG{n}{col1}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{2}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{5}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{8}\PYG{o}{\textbar{}}
\PYG{n}{col1}                            \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{a}     \PYG{l+m+mf}{6.0}   \PYG{n}{NaN}   \PYG{n}{NaN}           \PYG{o}{\textbar{}}   \PYG{n}{c}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{18}\PYG{o}{\textbar{}}
\PYG{n}{b}     \PYG{n}{NaN}  \PYG{l+m+mf}{12.0}   \PYG{n}{NaN}           \PYG{o}{\textbar{}}   \PYG{n}{b}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}  \PYG{l+m+mi}{12}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
\PYG{n}{c}     \PYG{n}{NaN}   \PYG{n}{NaN}  \PYG{l+m+mf}{18.0}           \PYG{o}{\textbar{}}   \PYG{n}{a}\PYG{o}{\textbar{}}   \PYG{l+m+mi}{6}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}\PYG{n}{null}\PYG{o}{\textbar{}}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\chapter{Package Wrapper}
\label{\detokenize{pack:package-wrapper}}\label{\detokenize{pack:pack}}\label{\detokenize{pack::doc}}
It’s super easy to wrap your own package in Python. I packed some functions which I frequently
used in my daily work. You can download and install it from \sphinxhref{https://github.com/runawayhorse001/PySparkTools}{My PySpark Package}. The hierarchical
structure and the directory structure of this package are as follows.


\section{Hierarchical Structure}
\label{\detokenize{pack:hierarchical-structure}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
PySparkTools/
├── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
├── PySparkTools
│   ├── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
│   ├── Manipulation
│   │   ├── DataManipulation.py
│   │   └── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
│   └── Visualization
│       ├── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
│       ├── PyPlots.py
│       └── PyPlots.pyc
├── README.md
├── requirements.txt
├── setup.py
└── \PYG{n+nb}{test}
    ├── spark\PYGZhy{}warehouse
    ├── test1.py
    └── test2.py
\end{sphinxVerbatim}

From the above hierarchical structure, you will find that you have to have \sphinxcode{\sphinxupquote{\_\_init\_\_.py}} in each directory. I will explain the \sphinxcode{\sphinxupquote{\_\_init\_\_.py}} file with the example below:


\section{Set Up}
\label{\detokenize{pack:set-up}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{setuptools} \PYG{k+kn}{import} \PYG{n}{setup}\PYG{p}{,} \PYG{n}{find\PYGZus{}packages}

\PYG{k}{try}\PYG{p}{:}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{README.md}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
        \PYG{n}{long\PYGZus{}description} \PYG{o}{=} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{except} \PYG{n+ne}{IOError}\PYG{p}{:}
    \PYG{n}{long\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{try}\PYG{p}{:}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{requirements.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
        \PYG{n}{requirements} \PYG{o}{=} \PYG{p}{[}\PYG{n}{x}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{splitlines}\PYG{p}{(}\PYG{p}{)} \PYG{k}{if} \PYG{n}{x}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}
\PYG{k}{except} \PYG{n+ne}{IOError}\PYG{p}{:}
    \PYG{n}{requirements} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{n}{setup}\PYG{p}{(}\PYG{n}{name}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PySParkTools}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
          \PYG{n}{install\PYGZus{}requires}\PYG{o}{=}\PYG{n}{requirements}\PYG{p}{,}
      \PYG{n}{version}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{description}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Python Spark Tools}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{author}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Wenqiang Feng}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{author\PYGZus{}email}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{von198@gmail.com}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{url}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{https://github.com/runawayhorse001/PySparkTools}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{packages}\PYG{o}{=}\PYG{n}{find\PYGZus{}packages}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
      \PYG{n}{long\PYGZus{}description}\PYG{o}{=}\PYG{n}{long\PYGZus{}description}
     \PYG{p}{)}
\end{sphinxVerbatim}


\section{ReadMe}
\label{\detokenize{pack:readme}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} PySparkTools}

This is my PySpark Tools. If you want to colne and install it, you can use

\PYGZhy{} clone

\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
git clone git@github.com:runawayhorse001/PySparkTools.git
\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}
\PYGZhy{} install

\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
\PYG{n+nb}{cd} PySparkTools
pip install \PYGZhy{}r requirements.txt
python setup.py install
\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}

\PYGZhy{} \PYG{n+nb}{test}

\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
\PYG{n+nb}{cd} PySparkTools/test
python test1.py
\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}\PYG{l+s+sb}{{}`}
\end{sphinxVerbatim}


\chapter{Main Reference}
\label{\detokenize{reference:main-reference}}\label{\detokenize{reference:reference}}\label{\detokenize{reference::doc}}
\begin{sphinxthebibliography}{VanderPl}
\bibitem[VanderPlas2016]{reference:vanderplas2016}
Jake VanderPlas. \sphinxhref{https://tanthiamhuat.files.wordpress.com/2018/04/pythondatasciencehandbook.pdf}{Python Data Science Handbook: Essential Tools for Working with Data, 2016.}
\bibitem[McKinney2013]{reference:mckinney2013}
Wes McKinney. \sphinxhref{http://bedford-computing.co.uk/learning/wp-content/uploads/2015/10/Python-for-Data-Analysis.pdf}{Python for Data Analysis, 2013.}
\bibitem[Georg2018]{reference:georg2018}
Georg Brandl. \sphinxhref{https://media.readthedocs.org/pdf/sphinx/1.7/sphinx.pdf}{Sphinx Documentation, Release 1.7.10+, 2018.}
\end{sphinxthebibliography}



\renewcommand{\indexname}{Index}
\printindex
\end{document}